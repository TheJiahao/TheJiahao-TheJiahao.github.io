---
import type { BlogProps } from "../components/BlogCard";
import BlogList from "../components/BlogList";
import NavigationBar from "../components/NavigationBar";
import SiteFooter from "../components/SiteFooter";
import ToolBar from "../components/ToolBar";
import getBlogs from "../utils/getBlogs";
import { getTranslation } from "../utils/translation";
import BaseLayout from "./BaseLayout.astro";

interface Props {
    lang: string;
}

const { lang } = Astro.props;

const blogs: BlogProps[] = (await getBlogs())
    .filter((blog) => blog.lang === lang)
    .map((blog) => {
        const { data, lang, slug } = blog;

        return { ...data, url: `${lang}/posts/${slug}` };
    })
    .sort((a, b) => +b.date - +a.date);
---

<BaseLayout
    lang={lang}
    title={getTranslation(lang).siteTitle}
    description={getTranslation(lang).siteDescription}
>
    <div flex="~ col" min-w-60ch p-4 gap-4 lg="flex-row">
        <NavigationBar lang={lang} />
        <div w-full flex="~ col" gap-10 my-2>
            <ToolBar lang={lang} client:only="react" />
            <main>
                <BlogList blogs={blogs} />
            </main>

            <SiteFooter lang={lang} />
        </div>
    </div>
</BaseLayout>
