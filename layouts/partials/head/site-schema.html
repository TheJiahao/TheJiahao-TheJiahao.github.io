{{ $license := default .Site.Params.article.license.default .Params.License | markdownify }}

{{ if .IsHome -}}
<script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "url": "{{ .Site.BaseURL }}",
    {{ with .Site.Params.Author -}}
    "author": {
        "@type": "Person",
        "name": "{{ .Name }}"
    },
    {{- end }}
    {{ with .Params.Description -}}
    "description": "{{ . }}",
    {{- end -}}
    {{ with .Site.Params.image -}}
    "image": "{{ .url | absURL }}",
    {{- end }}
    {{ with .Site.Params.logo -}}
    "thumbnailUrl": "{{ .url | absURL }}",
    {{- end -}}
    {{- with $license -}}
    "license": "{{ . }}",
    {{- end }}
    "name": "{{ .Site.Title }}",
    "potentialAction": {
        "@type": "SearchAction",
        "target": {
            "@type": "EntryPoint",
            "urlTemplate": "https://thejiahao.github.io/search/?keyword={search_term_string}"
        },
        "query-input": "required name=search_term_string"
    }
}
</script>
{{- else if .IsPage -}}
<script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "{{ .Title }}",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "{{ .Permalink }}"
    },
    {{- $image := partialCached "helper/image" (dict "Context" . "Type" "article") .RelPermalink "article" -}}
    {{ with $image.permalink }}
    "image": {{ . }},
    {{- end }}
    "genre": "{{ .Type }}",
    {{ with (or .Params.Keywords .Params.Tags) -}}
    "keywords": "{{ delimit . ", " }}",
    {{- end }}
    "wordcount": {{ .WordCount }},
    "url": "{{ .Permalink }}",
    {{- with .Date -}}
    "datePublished": "{{ .Format "2006-01-02T15:04:05-07:00" | safeHTML }}",
    {{- end }}
    {{ with .Lastmod -}}
    "dateModified": "{{ .Format "2006-01-02T15:04:05-07:00" | safeHTML }}",
    {{- end }}
    {{ with $license -}}
    "license": "{{ . }}",
    {{- end }}
    {{ with (or .Params.Author .Site.Params.Author.Name) -}}
    "author": {
        "@type": "Person",
        "name": "{{ . }}"
    },
    {{- end -}}
    {{- with (or .Description .Summary) }}
    "description": "{{ . }}"
    {{- end -}}
    }
</script>
{{- end }}
